<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Post - Kıvanç's Pancake House</title>

    <!-- Bootstrap Core CSS -->
    <link href="../../../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../../../css/business-casual.css" rel="stylesheet">

    <!-- Fonts -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Josefin+Slab:100,300,400,600,700,100italic,300italic,400italic,600italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="http://latex.codecogs.com/latexit.js"></script>
    LatexIT.add('p',true);

</head>

<body>

    <div class="brand">Kıvanç's Pancake House</div>
    <div class="address-bar">İstanbul, Turkey</div>

    <!-- Navigation -->
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- navbar-brand is hidden on larger screens, but visible when the menu is collapsed -->
                <a class="navbar-brand" href="index.html">Kıvanç's Pancake House</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="../../../index.html">About</a>
                    </li>
                    <li>
                        <a href="../../../math.html">Math</a>
                    </li>
                    <li>
                        <a href="../../../chindogu.html">Chindogu</a>
                    </li>
                    <li>
                        <a href="../../../blog.html">Blog</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <div class="container">
        <div class="row">
            <div class="box">
                <div class="col-lg-12 text-left">
		<h1 class="entry-title">Notes on Cryptology</h1>
                <p>
		None of us would like to have third party who is able to sense our message. For this reason we usually change 
		-technically encrypt, our message in a way that third party can not realize, whereas our communication partner can, 
		since he is aware of how we changed it.
		</p>

		<p>Let's say that we have a message <b lang="latex">M</b>. Instead of directly transmitting it, we use a function <b lang="latex"> E(M) = C</b> to encrypt it. 
		Even third party has an access to <b lang="latex">C</b>. However, she can't get <b lang="latex">M</b> from <b lang="latex">C</b> since she is not aware of our encryption function. 
		However, our destination has a function, that produces <b lang="latex">M</b> from this encrypted <b lang="latex">C</b>. Mathematically speaking, this one is called <i>as 
		decryption function which is an inverse of encryption function:</i> <b lang="latex"> D( E(M) ) = D(C) = M</b>
		</p>
		<p>For beginning, we examine <b>Substitution Cipher</b> method which used by <b>Julius Caesar</b>. The method is quite simple: 
		substitute each letter in phrase with <b lang="latex">N</b> shift.</p>
	
		<p>So, if <b lang="latex">N = 1</b> and Caesar wants to say <b>"hello"</b> to his soldiers, had written <b>"ifmmp"</b> on paper, then sent. 
		Third party would get encrypted version of message and could not understand what he was saying, 
		whereas his soldiers could, since they know encryption method of their Emperor.
		</p>
		<p>Another method that used from him -as an improved cipher- was <b>Transposition Cipher</b>. So instead of shifting each character, he uses a key to 
		change locations of letters. Here we need to have a key. Let's assume that our key is <b>24153</b>. So, 
		our <b>"hello"</b> becomes <b>"elhol"</b>. This seems useless for only "hello". 
		However let's say that he has a longer phrase:
		</p>
		<blockquote>
			When the power of love overcomes the love of power the world will know peace
		</blockquote>
		
		<p>Here, we'll use previous key <b>24153</b>. So, if we parse our message for each consecutive 5 letters, we would have:</p>

		<ul>
			<li><p><b>whent hepow erofl oveov ercom esthe loveo fpowe rthew orldw illkn owpea ce.</b></p></li>
		</ul>		
		<p>and encrypted version with key would be:</p>
		<ul>
			<li><p><b>hnwte eohwp rfelo voove roemc sheet oelov pwfeo terwh rdowl lkinl weoap ec</b></p></li>
		</ul>
		<p>If Caesar would also not use blank-spaces after encryption, message becomes harder to understand:</p>
		<ul>
			<li><p><b>hnwteeohwprfelovooveroemcsheetoelovpwfeoterwhrdowllkinlweoapec</b></p></li>
		</ul>
		<p>
		<b>In summary:</b> Transmitter encrypts his message <b lang="latex">M</b> before sending with key <b lang="latex"> K_1</b> and produces <b lang="latex">C</b>. 
		Consequently, receiver uses his key <b lang="latex"> K_2</b> to decrypt it. If those keys are same -such as in last example, we call this procedure as 
		<b>symmetric</b> cryptosystem. On the other hand, if they are not equal, we call this as <b>asymmetric</b> crpytosystem.
		</p>

		<p>Caesar and soldiers of him used a kind of private method in between them. In other words, they had a deal to 
		change locations of letters in phrase -or shift letters, before transmission of	message. However, today's world is quite different.
		</p>
		
		<p>For example, you would like to send an e-mail to one that you have never ever met before. 
		Since this message travels on many different machines -routers, e-mail servers etc. you need to 
		encrypt it as well. However, you can not use an approach like Caesar's transposition or key-shift at all, 
		since your prospective receiver does not have any idea about what would you do.</p>
		<p>For this reason, you need to express how would you encrypt your message -which should be a common technique that everyone knows. 
		Third party may realize your technique as well, but still this 	technique needs to provide your privacy against her. 
		Below, I provide most common <b>public key</b> algorithm developed by Ron <b>R</b>ivest, Adi <b>S</b>hamir and Len <b>A</b>dleman which named <b>RSA</b>.</p>
		
		<p>Let's suppose that I aim to send an e-mail to Bob. Also, assume that there is a third party who has an access to router in between me and Bob.</p>
		
		<p>Here is a symbolic step-by-step pattern about operation:</p>
		
		<p><ol>
			<li><p>I send a signal message to Bob which denotes my communication intend and encryption approach.
			<br> 
			Third party can realize the situation.</p></li>
			<li><p>Bob produces <b>public key</b> and <b>private key</b>. Consequently, he keeps private key for his own use and sends public key to me.
			<br> 
			Third party can get this public key as well.</p></li>
			<li><p>Afterwards, I use this public key to <b>encrypt</b> my data(<b lang="latex">M</b>) message than send encrypted version(<b lang="latex">C</b>) 
			of it to Bob. Third party can get this encrypted message as well, however can't decrypt -or we can say that he can't effortless decrypt, 
			since he does not have the private key.</p></li>
			<li><p>Alice receives encrypted message(C) and uses her private key to decrypt it</p></li>
		</ol></p>
		
		<p>From now on, we break into math to support this symbolic pattern and follow the structure of RSA.</p>
		
		<p>There is no math in first step. Simply, I would only denote that "I would like to have communication with you and I'll use RSA encryption". 
		Since <b>RSA</b> is commonly used, he knows how to follow step's of it.</p>
		
		<p>Here we start from <b>Step 2</b>.</p>

		<p>After obtaining my intention, Bob needs to produce <b>public key for my encryption</b> and <b>private key for his decryption</b>. 
		In order to produce a public key, Bob selects two different prime numbers <b lang="latex">p</b> and <b lang="latex">q</b>, then calculates modulus 
		<b lang="latex"> n = p.q</b>
		<br>
		Say, <b lang="latex"> p = 19, q = 11, n = 209</b>.</p>
		
		<p>Afterwards, he computes <b lang="latex"> \phi(n)</b> which is called <a href="../euler_totient/euler_totient.html">totient function</a> 
		of <b lang="latex">n</b> and gives amount of numbers that are smaller than <b lang="latex">n</b> and relatively prime with <b lang="latex">n</b>.</p>
		
		<p>Since <b lang="latex">p</b> and <b lang="latex">q</b> are prime numbers, we can say that <b lang="latex"> \phi(n) = (p-1).(q-1)</b>. If you are not comfortable 
		with value of <b lang="latex"> \phi(n)</b>, you could check the link that I provide for totient function. Otherwise, go on. <b lang="latex"> \phi(209) = 180</b>.</p>
		
		<p>Following, he selects an integer <b lang="latex">e</b> where <b lang="latex">1 < e < \phi(n)</b> 
		and <b lang="latex"> gcd(e, \phi(n)) = 1</b>. Let's assume <b lang="latex"> e = 29</b>. Here, public key is <b lang="latex">(n,e)</b> pair, 
		where Bob sends me to use for encryption. For his decryption purposes, Bob needs a <b>private key</b> (<b lang="latex">d</b>) 
		which satisfies <b lang="latex"> \bmod(e.d, \phi(n)) = 1</b>. 
		Value <b lang="latex">d</b> is also called as multiplicative inverse 
		of <b lang="latex">e</b> modulo <b lang="latex"> \phi(n)</b> and <b lang="latex"> d = 149</b> satisfies for numbers above.</p>
		
		<p>Now we are in <b>Step 3</b>.</p>
		
		<p>I get my public key from Bob, which is <b lang="latex">(n,e)</b>. Here undesirable third party also aware of what public key is. 
		Consequently, I produce encrypt version <b lang="latex">C</b> of my message <b lang="latex">M</b> by using public key. 
		Here my message <b lang="latex">M</b> should be less than my modulus, 
		<b lang="latex"> M = p.q</b>. In practice people use huge numbers for <b lang="latex">p</b> and <b lang="latex">q</b>, 
		which increases security of method. So, my <b lang="latex">M</b> is an integer, 
		if it is greater than <b lang="latex">n</b>, I can first parse then send it etc. Followingly, I encrypt my message <b lang="latex"> C = \bmod(M^e, n)</b>. 
		Let's assume that I would like to send a single <a href="http://www.asciitable.com/">integer</a> 
		as a message, which equals to <b lang="latex">15</b>. So, <b lang="latex"> E(15) = C = \bmod(15^{29}, 209) </b>.</p>
		
		<p>Since calculating <b lang="latex"> 15^{29}</b> might take significant amount of time, we need to get benefits of modular arithmetic:</p>

		<p><b lang="latex"> \bmod(15^2, 209) = 16</b></p>

		<p><b lang="latex"> \bmod(15^4,209) = \bmod( (209 + 16)(209 + 16), 209) = \bmod(16^2, 209) = 47</b></p>

		<p>Similarly,</p>

		<p><b lang="latex"> \bmod(15^8,209) = \bmod(15^{4} .15^{4}, 209)</b></p> 
		<p><b lang="latex"> \rightarrow \bmod( (209K + 47).(209K + 47), 209)</b></p>
		<p><b lang="latex"> \rightarrow \bmod(47^2,209) = \bmod(2209,209) = 119</b></p>

		<p><b lang="latex"> \bmod(15^{16},209) = \bmod(119^2,209) = \bmod(14161,209) = 158</b></p>

		<p>So, <b lang="latex"> C = \bmod(15^{29},209) = \bmod(15.47.119.158, 209) = \bmod(78.201, 209) = 3</b></p>
		
		<p>Finally we are in <b>Step 4</b>.</p>

		<p>So, Bob and third party received my encrypted message <b lang="latex">C</b>. Here, they both would try to 
		get message (<b lang="latex">M</b>) from it. Here, we prove that Bob can get it by using his private key. 
		Before doing so, we need proof of two following little theorems.</p>		
		<p><b>Small Theorem 1:</b></p>

		<p><b lang="latex"> \bmod(M^{ed}, n) = \bmod(C^{d}, n)</b></p>
		
		<p><b>Small Proof 1:</b></p>

		<p>Since <b lang="latex"> C = \bmod(M^e, n)</b>, we can say that <b lang="latex"> M^e = K.n + C</b>. 
		Therefore, <b lang="latex"> \bmod(M^{ed}, n) = \bmod((KN + C)^d, n) = \bmod(C^d, n)</b></p>
		
		<p><b>Small Theorem 2:</b></p>

		<p>Let M be an integer. Let p and q be prime numbers which have different values. 
		Then if <b lang="latex"> \bmod(a, p) = M</b> and <b lang="latex"> \bmod(a,q) = M</b> equation <b lang="latex"> \bmod(a, p.q) = M</b> should also satisfy.
		</p>

		<p><b>Small Proof 2:</b></p>
		
		<p>We can say that <b lang="latex"> a = M + p.i</b> and <b lang="latex"> a = M + q.j</b>. So, <b lang="latex"> p.i = q.j</b>. 
		This implies that, q.j is a multiple of p. We also now that, p can not be a divisor of q, 
		since they both are prime and they have different values. So, we can say that, <b lang="latex"> j = p.K</b> 
		hence <b lang="latex"> a = M + q.p.K</b> Following, we conclude this small proof: <b lang="latex"> \bmod(a, p.q) = \bmod(M + q.p.K, p.q) = M</b>.</p>
		
		<p><b>Now we are so close to conclude working principle of RSA!</b></p>
		
		<p>So, Bob received C from me. Here we use, first small theorem than try to show that <b lang="latex"> \bmod(M^{ed}, n) = M</b>. If we can, we conclude!.</p>
		<p>Here we go for final time:</p>
		<ul>
			<li><p>If <b lang="latex">M</b> is a multiple of <b lang="latex">p</b>, <b lang="latex"> \bmod(M, p) = 0</b> 
			since <b lang="latex"> M = p.w</b>.<br> 
			We can say that <b lang="latex"> M^{ed} = (p.w)^{ed} = p.p^{ed-1}.w^{ed} \rightarrow \bmod(M^{ed}, p) = \bmod(M, p)</b>.<br>
			Therefore, we have <b lang="latex"> \bmod(M^{ed}, p) = \bmod(M, p) = 0</b>
			<br>
			This is similar for <b lang="latex">q</b> as well.
			If <b lang="latex">M</b> is a multiple of <b lang="latex">q</b>, then we have <b lang="latex"> \bmod(M^{ed}, q) = \bmod(M, q) = 0</b>
			<br>
			At the very beginning, 
			we assumed that <b lang="latex"> M < p \times q </b>. By using this assumtion and <b>small theorem 2</b>, 
			we can say that <b lang="latex"> \bmod(M^{ed}, pq) = \bmod(M, p.q) = M</b> </p></li>
			<li><p>As a second case, we consider: <b>p is not a divisor of M.</b>
			<br>
			<b lang="latex"> M^{ed} = M^{ed-1}. M</b>
			<br>
			<b lang="latex"> \rightarrow M^{(p-1).(q-1).k}. M</b>
			<br>
			<b lang="latex"> \rightarrow M^{(p-1)^{(q-1).k}}.M</b>
			<br>
			<br>
			Here, we would consider <b lang="latex"> \bmod( M^{ed}, p) = \bmod( M^{(p-1)^{(q-1).k}}, p)</b>
			<br>
			From <a href="#">Fermat's Little Theorem</a>, we know that, for any prime p and integer M <b lang="latex"> \bmod(M^{p-1}, p) = 1</b>
			<br>
			<br>
			So, <b lang="latex"> \bmod( M^{(p-1)^{(q-1).k}}, p) = \bmod( (Kp + 1)^{(q-1).k}.M, p) = \bmod(M, p)</b><br>
			The equations for second case would be exactly same for <b lang="latex"> \bmod(M^{ed}, q)</b> as well.<br>
			So, since <b lang="latex"> \bmod(M^{ed}, p) = \bmod(M,p)</b> and <b lang="latex"> \bmod(M^{ed},q) = \bmod(M,q)</b>, by using small theorem 2, 
			we have <b lang="latex"> \bmod(M^{ed}, pq) = \bmod(M, pq)</b> Lastly, since we assumed that <b lang="latex"> M < p.q</b>, we can proudly 
			say that <b lang="latex"> \bmod(M^{ed}, pq) = \bmod(M, pq) = M</b> which completes proof.
			<br> 
			<br>
			Here we numerically conclude as well: <b lang="latex"> C = 3</b> and <b lang="latex"> M = \bmod(C^{d}, n) = \bmod(3^{149}, 209) = 15</b> 
			So, a third party should find prime coefficients of <b lang="latex">n</b> -which are. 
			If she could, she could get private key <b lang="latex">d</b> as well and decode message just as receiver. 
			However, since people generally uses huge numbers for <b lang="latex">p</b> and <b lang="latex">q</b>, 
			it's hard to factorize <b lang="latex">n</b>, which provides security of method.
			</p></li>
		</ul>

			
        <i>References:</i>
        <ol>
            <li><a href="https://en.wikipedia.org/wiki/RSA_%28cryptosystem%29">RSA, wiki page</a></li>
	    <li><a href="http://www.matematikdunyasi.org/">Matematik Dünyası</a>, Sayı:71 -Turkish Popular Science Journal</li>
	    <li>	<a href="http://www.braingle.com/brainteasers/codes/caesar.php">
	        	http://www.braingle.com/brainteasers/codes/caesar.php</a>
	    </li>
	    <li>	<a href="http://practicalcryptography.com/ciphers/simple-substitution-cipher/">
	        	http://practicalcryptography.com/ciphers/simple-substitution-cipher/</a>
	    </li>
	    <li><a href="http://www.richkni.co.uk/php/crypta/trans0.php">
	        	http://www.richkni.co.uk/php/crypta/trans0.php</a>
	    </li>
	    <li>	<a href="http://exploringnumbertheory.wordpress.com/2013/07/08/fermats-little-theorem-and-rsa-algorithm/">
			http://exploringnumbertheory.wordpress.com/2013/07/08/fermats-little-theorem-and-rsa-algorithm/</a>
	    </li>
        </ol>
		</div>
            </div>
        </div>
    </div>
    <!-- /.container -->

    <footer>
        <div class="container">
            <div class="row">
                <div class="box">
                    <div class="col-lg-12 text-center">
                        <p>Copyright &copy; Kıvanç Çakmak 2016</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
