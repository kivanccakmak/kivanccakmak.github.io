<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>The Notebook</title>

    <!-- Bootstrap Core CSS -->
    <link href="../../../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../../../css/business-casual.css" rel="stylesheet">

    <!-- My CSS -->
    <link href="../../../css/my.css" rel="stylesheet">

    <!-- Fonts -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Josefin+Slab:100,300,400,600,700,100italic,300italic,400italic,600italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="../../../js/latexit.js"></script>

</head>

<body>

    <div class="brand">The Notebook</div>
    <div class="address-bar">İstanbul, Turkey</div>

    <!-- Navigation -->
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- navbar-brand is hidden on larger screens, but visible when the menu is collapsed -->
                <a class="navbar-brand" href="index.html">The Notebook</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="../../../index.html">About</a>
                    </li>
                    <li>
                        <a href="../../../math.html">Math</a>
                    </li>
                    <li>
                        <a href="../../../chindogu.html">Chindogu</a>
                    </li>
                    <li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <div class="container">
        <div class="row">
            <div class="box">
                <div class="col-lg-12 text-left">
		<h1 class="entry-title">Asymptotic Equipartition Property</h1>

		This blog post aims to introduce the concept of typical sequence, and some properties of these typical sequences, which are collectively known as Asymptotic Equipartition Property.

		<br><br>

		<p><b>Typicality</b></p>

		Consider a sequence of <b lang="latex">L = 20</b> bits emitted by a discrete memoryless source (DMS) with: <b lang="latex">P_{U}(0) = \frac{3}{4},\:\: P_{U}(1) = \frac{1}{4}</b>

		<br><br>

		<p class="equation"> <b lang="latex">
		1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
		</b></p>

		<br>

		<p class="equation"> <b lang="latex">
		1,0,1,0,1,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0
		</b></p>

		<br>

		<p class="equation"><b lang="latex">
		0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
		</b></p>

		<br><br>

		The first sequence is a all one sequence. The second one has 14 zeros and
		6 ones, and the third is a all zero sequence. <br> <br>
		Probability of occurrence of the sequences are:
		<br><br>

		<p class="equation"><b lang="latex">\frac{1}{4}^{20}$</b>, <b lang="latex">\frac{1}{4}^{20}\times3^{14}</b>, <b lang="latex">\frac{1}{4}^{20}\times3^{20}</b></p> respectively.

		<br><br>

		All zero and all one sequence are very unlikely to come out of this source
		because we have been given that: 
		<br><br>

		<p class="equation"><b lang="latex">P_{U}(0) = \frac{3}{4},\:\: P_{U}(1) = \frac{1}{4}</b></p>

		<br><br>

		If we take large enough block size it is likely that we should get 0 three fourth of time, and we should get 1 one fourth of time.

		<br><br>

		If we had <b lang="latex">P_{U}(0) = 0.99,\:\: P_{U}(1) = 0.01</b>, then we can say the all zero sequence is most likely to happen.

		<br><br>
		The second sequence has 14 zeros and 6 ones. Roughly if we take large enough bits, I expect <b lang="latex">\frac{3}{4}$</b> number of 1s and rest to be zero. 

		<br><br>
		
		Now, we will formally define what is a typical sequence and then we will show some properties of a typical sequence.

		<br><br>

		<ol>
			<li>Let <b lang="latex">\textbf{U}</b> denote an output sequence of length <b lang="latex">\textbf{L}</b> emitted a K-ary DMS and <b lang="latex">P_{U}(u)</b> is the output probability distribution.</li>
			<li>Let <b lang="latex">$n_{ai}(u)</b> denotes the number of occurence of the letter <b lang="latex">a_{i}</b> in the sequence <b lang="latex">\textbf{u}</b><li>Let <b lang="latex">\textbf{u} = [$u_{1}$, $u_{2}$, ..., $u_{L}</b>] denote possible values of, i.e. <b lang="latex">u_{j} = \{{a_{1}, a_{2}, ..., a_{K}}\}</b> for <b lang="latex">1 \leq j \leq L</b>.</li>
		</ol>
		Then <b lang="latex">\textbf{u}</b> is an <b lang="latex">\epsilon-</b>typical sequence of length <b lang="latex">\textbf{L}</b> for this K-ary DMS if:
		
		<br><br>

		<p class="equation"><b lang="latex">(1 - \epsilon)P_{u}(a_{i}) \leq \frac{n_{ai}(\textbf{u})}{L} \leq (1 + \epsilon) P_{u}(a_{i})$, $1 \leq i \leq K</b></li></p>

		<br><br>

		Please note <b lang="latex">\epsilon</b> is a small number. We consider the same example as we considered earlier.

		<br><br>
		<p><b>Properties</b></p>

		<br>
		<i><b>Property 1:</b></i> If <b lang="latex">\textbf{u}</b> is an <b lang="latex">\epsilon-</b>typical output sequence of length <b lang="latex">\textbf{L}</b> from a K-ary DMS with entropy <b lang="latex">H(U)</b> in bits, then:

		<br><br>
		<p class="equation"><b lang="latex">2^{-(1+\epsilon)LH(U)} \leq P_{U}(\textbf{u}) \leq 2^{-(1-\epsilon)LH(U)}</b></p>

		<br><br>
		<i><b>Proof:</b></i>  From the definition of a DMS, we have

		<br><br>

		<p class="equation"><b lang="latex">P_{U}(\textbf{u}) = \prod\limits_{j=1}^L P_{U}(u_{j})</b></p>

		<br><br>

		So, since this is a K-ary source, it will emit <b lang="latex">$a_{1}, a_{2}, \dots, a_{K}$</b>. 

		<br><br>
		
		So, let us say <b lang="latex">$a_{1}$</b> is emitted <b lang="latex">$n_{a1}(u)$</b> times, <b lang="latex">$a_{2}$</b> is emitted <b lang="latex">$n_{a2}(u)$</b> times, similarly <b lang="latex">$a_{K}$</b> is <b lang="latex">$n_{aK}(u)$</b> times. 

		<br><br>
		Consequently, we can write:
		<br><br>

		<p class="equation"><b lang="latex">P_{U}(\textbf{u}) = \prod_{j=1}^LP_{U}(u_{j}) = \prod_{i=1}^K[P_{U}(a_{i})]^{n_{ai}(\textbf{u})}</b></p>

		<br><br>

		Here, we can say that:

		<br><br>

		<p class="equation"><b lang="latex">P_{U}(\textbf{u}) = \prod_{i=1}^K[P_{U}(a_{i})]^{n_{ai}(\textbf{u})} = \prod_{i=1}^K[P_{U}(a_{i})]^{LP_{U}(a_{i})} \geq \prod_{i=1}^K[P_{U}(a_{i})]^{(1+\epsilon)LP_{U}(a_{i})}</b></p>

		<br><br>
		since raising a power of a number in between 0 and 1 (which is probability of <b lang="latex">$a_{i}$</b> in this case) with a positive number (which is <b lang="latex">$\epsilon$</b> in this case) decreases it's value.

		<br><br>
		Equivalently (see logarithmic exchange part below),

		<br><br>

		<p class="equation"><b lang="latex">P_{U}(\textbf{u}) \geq \prod_{i=1}^K2^{(1+\epsilon)LP_{U}(a_{i})\log_{2}P_{U}(a_{i})}</b></p>

		<br><br>
		Simplifying we get,

		<br><br>

		<p class="equation"><b lang="latex">P_{U}(\textbf{u}) \geq 2^{(1+\epsilon) L \sum\limits_{i=1}^KP_{U}(a_{i})\log_{2}P_{U}(a_{i})}</b></p>

		<br><br>

		Hence,

		<br><br>
		<p class="equation"><b lang="latex">P_{U}(\textbf{u}) \geq 2^{-(1+\epsilon)LH(U)}</b></p>
		<br><br>

		Similar arguments can be used to prove
		<br><br>
		<p class="equation"><b lang="latex">P_{U}(\textbf{u}) \leq 2^{-(1-\epsilon)LH(U)}</b></p>


		<br><br>
		<i><b>Property 2:</b></i> The probability <b lang="latex">1 - P(F)</b>, that the lenght <b lang="latex">\textbf{L}</b> output sequence <b lang="latex">\textbf{U}</b>  from a K-ary DMS is <b lang="latex">$\epsilon-</b>typical satisfies:

		<br><br>
		<p class="equation"><b lang="latex">1 - P(F) \leq 1 - \frac{K}{L\epsilon^{2}P_{min}}</b></p> 

		<br>
		where <b lang="latex">P_{min}</b> is the smallest positive value of <b lang="latex">$P_{U}(u)</b>

		<br><br>
		<i><b>Proof:</b></i> Interested to show that for large <b lang="latex">\textbf{L}</b>, the output sequence <b lang="latex">\textbf{U}</b> of the DMS is certain to be <b lang="latex">\epsilon-</b>typical.

		<br><br>
		Here, we will use <a href="http://kivanccakmak.com/posts/math/law_of_large/law_of_large.html">Tchebychef</a> inequality: 

		<p class="equation"><b lang="latex">P(|\frac{n_{A}}{n} - P(A)| \geq \epsilon) \leq \frac{P(A)[1-P(A)]}{n\epsilon^2}</b></p> 

		Let <b lang="latex">B_{i}</b> denote the event that <b lang="latex">\textbf{U}</b> takes on value <b lang="latex">\textbf{u}</b> such that the condition for <b lang="latex">\epsilon-</b>typical sequence is not satisfied. 
		<br><br>
		
		Then,

		<br>

		<p class="equation"> 
		<b lang="latex">
			P(B_i) = P(|\frac{n_{a_{i}}}{L} - P_{U}(a_i)| > \epsilon P_{U}(a_i))
		</b>
		</p> 

		<br>
		here, we can say that

		<p class="equation">
		<b lang="latex">
			P(B_i) \leq \frac{P_{U}(a_i)[1 - P_{U}(a_i)]}{L[\epsilon P_{U}(a_i)]^2}
		</b>
		</p>

		<br>
		Simplifying, we have

		<br>

		<p class="equation">
		<b lang="latex">
		P(B_i) \leq \frac{1 - P_{U}(a_i)}{L \epsilon^{2}P_U(a_i)}
		</b>
		</p>

		Let <b lang="latex">P_{min}</b> is the minimum non-zero value of <b lang="latex">P_{U}(u)</b>, we get,

		<br><br>
		<p class="equation">
		<b lang="latex">
			P(B_{i}) < \frac{1}{L \epsilon^{2}P_{min}}
		</b>
		</p>

		Let <b lang="latex">F</b> be the failure event that <b lang="latex">\textbf{U}</b> is not <b lang="latex">\epsilon-</b>typical. 
		
		<br><br>
		Since <b lang="latex">F</b> occurs in at least one of the events, <b lang="latex">B_i, 1 \leq i \leq K</b>, using union bounds we get:

		<br><br>
		<p class="equation">
		<b lang="latex">
		P(F) \leq \sum_{i=1}^{K}P(B_i) < \frac{K}{L \epsilon^2 P_{min}}
		</b>
		</p>

		<i><b>Property 3: </b></i>The number <b lang="latex">M</b> of <b lang="latex">\epsilon-</b>typical sequence <b lang="latex">\textbf{u}</b> from a K-ary DMS with entropy <b lang="latex">H(U)</b> in bits satisfies:

		<br><br>

		<p class="equation"> 
		<b lang="latex"> 
		(1 - \frac{K}{L \epsilon^2 P_{min}}) . 2^{(1-\epsilon)LH(U)} < M \leq 2^{(1 + \epsilon)LH(U)}
		</b> 
		</p> 

		<br><br>
		<i><b>Proof: </b></i> We know that

		<br><br>
		<p class="equation"> 
		<b lang="latex"> 
		1 = \sum_{\forall u} P_{U}(u) \geq M . 2 ^{-(1 + \epsilon)LH(U)}
		</b> 
		</p> 

		<br>
		since <b lang="latex">P_u(u)</b> is lower bounded by <b lang="latex">2^{-(1+\epsilon)}LH(U)</b>.

		<br><br>
		This gives upper bound 

		<br><br>
		<p class="equation"> 
		<b lang="latex"> 
		M \leq 2 ^ {(1 + \epsilon)LH(U)}
		</b> 
		</p> 

		<br><br>
		Now we are going to prove the lower bound. Total probability of the <b lang="latex">\epsilon-</b>typical sequence is <b lang="latex">1-P(F)</b>, so

		<br><br>

		<br><br>
		<p class="equation"> 
		<b lang="latex"> 
		1 - P(F) \leq M . 2 ^ {-(1 + \epsilon)LH(U)}
		</b> 
		</p> 

		<br><br>
		using property-2, we know that <b lang="latex">P(F) \leq \frac{K}{L \epsilon ^2 P_{min}}</b>. 
		
		<br><br>
		This gives the lower bound.

		<br><br>
		<p class="equation"> 
		<b lang="latex"> 
		M > (1 - \frac{K}{L \epsilon^{2}P_{min}}) . 2 ^ {(1 - \epsilon)LH(U)}
		</b> 
		</p> 

		<br><br>
		Now, lets try to look at these results when <b lang="latex">\textbf{L}</b> is very large. We have shown
		three properties of typical sequences.

		<br><br>
		<ol>
			<li>each of these <b lang="latex">\epsilon-</b>typical sequences has probability equal to <b lang="latex">2^{-LH(U)}</b>.</li>
			<li>the total probability of these <b lang="latex">\epsilon-</b>typical sequences is very nearly 1</li>
			<li>when <b lang="latex">\textbf{L}</b> is large and <b lang="latex">\epsilon</b> is small, there are roughly <b lang="latex">2^{LH(U)}</b> amount of <b lang="latex">\epsilon-</b>typical sequences <b lang="latex">\textbf{u}</b>. </li>
		</ol>

		<br><br>
		<p><b>Appendix</b></p>

		<br>
		<i><b>Logarithmic Exchange:</b></i>
		<p class="equation"><b lang="latex"> $b^{\log_{b}(x)} = x$</b></p>
		<br>
		<i><b>Proof:</b></i>
		<b lang="latex">$log_{b}(x)$</b> answers <i>"b to what power equals x?"</i> via following property:
		<br><br>
		<p class="equation"><b lang="latex"> \log_{b}(x) = y \Leftrightarrow b^{y} = x</b></p>

		<br>
		<i><b>Variance and Mean of a Binary Random Variable:</b></i>
		<br><br>

		<i><b>Proof:</b></i>
		let's define a binary random variable first,

		<br>
		<p class="equation"> <b lang="latex"> P(X=0) = a$ and $P(X=1) = 1 - a</b> </p> 

		then, we can calculate the mean as following:
		<br>

		<p class="equation"> 
		<b lang="latex"> 
			E[X] & = (1 - P(X=1)) \times 0 + P(X=1) \times 1 = P(X=1) \\ \\
			&= (1 - a) \times 0 + a \times 1 \\
			& = a \\
		</b> 
		</p> 

		<br>
		likewise, we can calculate the variance as following:
		<br>

		<p class="equation"> 
		<b lang="latex"> 
		\mathrm{Var}[X] & = E[(X-\mu)^2] \\ \\
		& = (1 - P(X=1)) \times (0 - P(X=1))^2 + P(X=1) \times (1 - P(X=1))^2\\
		& = (1 - a) \times (0 - a)^2 + a \times (1 - a)^2 \\
		& = (1 - a) \times (a^2 +a - a^2) \\
		& = (1 - a) \times a
		</b> 
		</p> 

		<br><br>
        <i>References:</i>
        <ol>
            <li><a href="http://textofvideo.nptel.ac.in/117104129/lec9.pdf"</a>
	    http://textofvideo.nptel.ac.in/117104129/lec9.pdf</li>
        </ol>
		
		</div>
            </div>
        </div>
    </div>
    <!-- /.container -->

    <footer>
        <div class="container">
            <div class="row">
                <div class="box">
                    <div class="col-lg-12 text-center">
                        <p>Copyright &copy; Kıvanç Çakmak 2016</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
